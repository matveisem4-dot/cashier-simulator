// server.js (–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –±–ª–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)

// ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –¥–æ io.on)

io.on('connection', (socket) => {
    console.log(`üì° –ù–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ: ${socket.id}`);

    // –ö–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–≤–æ–µ–π –∫–æ–º–Ω–∞—Ç–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ pay.html
    socket.on('client_join_order', (orderId) => {
        socket.join(orderId);
        console.log(`üë§ –ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ –∑–∞–∫–∞–∑–∞: ${orderId}`);
    });

    // –ö–∞—Å—Å–∞ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∫–∞–Ω–∞–ª—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞ –ò –ø—Ä–∏—Å—ã–ª–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
    socket.on('join_cashier_order', (data) => {
        socket.join(data.orderId);
        console.log(`üõí –ö–∞—Å—Å–∞ –ø–æ–¥–∫–ª—é—á–∏–ª–∞—Å—å –∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É –∑–∞–∫–∞–∑–∞: ${data.orderId}`);

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –∏ –≤—ã–≤–æ–¥–∏–º –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
        const protocol = 'http';
        const host = 'localhost:3000'; 
        const paymentUrl = `${protocol}://${host}/pay.html?order_id=${data.orderId}&amount=${data.amount}`;
        
        console.log('--------------------------------------------------');
        console.log(`üîó –°–°–´–õ–ö–ê –î–õ–Ø –û–ü–õ–ê–¢–´ –ö–õ–ò–ï–ù–¢–ê: ${paymentUrl}`);
        console.log('--------------------------------------------------');

        // !!! –ù–û–í–û–ï: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç—É —Å–∏–≥–Ω–∞–ª –æ –Ω–æ–≤–æ–º –∑–∞–∫–∞–∑–µ, –µ—Å–ª–∏ –æ–Ω —É–∂–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        io.to(data.orderId).emit('new_order_ready', { 
            orderId: data.orderId, 
            amount: data.amount 
        });
    });

    // ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ confirm_payment_simulation –∏ disconnect)
});

// ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ server.listen)
